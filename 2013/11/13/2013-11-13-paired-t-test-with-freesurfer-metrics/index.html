<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Kong Brain Observatory"><title>对surface参数做配对T检验:以睡眠剥夺实验为例 | 小孔成像</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-26255736-1','auto');ga('send','pageview');
</script><script data-ad-client="ca-pub-7680017147908727" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">对surface参数做配对T检验:以睡眠剥夺实验为例</h1><a id="logo" href="/.">小孔成像</a><p class="description">Kong Brain Observatory</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/news/"><i class="fa fa-twitter"> News &amp; Events</i></a><a href="/collection/"><i class="fa fa-cloud"> Collection</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">对surface参数做配对T检验:以睡眠剥夺实验为例</h1><div class="post-meta">Nov 13, 2013<span> | </span><span class="category"><a href="/categories/BrainResearch/">BrainResearch</a></span></div><a class="disqus-comment-count" data-disqus-identifier="2013/11/13/2013-11-13-paired-t-test-with-freesurfer-metrics/" href="/2013/11/13/2013-11-13-paired-t-test-with-freesurfer-metrics/#disqus_thread"></a><div class="post-content"><p>在脑科学的研究中，带有操纵的前后测实验相对于个体差异或组间比较的实验，分量要相对大很多。而前后测往往就涉及到统计上的配对T检验。下面以一个例子记录一下针对Freesurfer生成的surface上的参数做配对T检验（Paired T-test）的流程。一方面自己备查，另一方面也希望对有相同需求的同学有所帮助。</p>
<p>这是一个前后测的研究，中间睡眠剥夺约72小时，共8名男性参与测试。下面的分析旨在考查72小时的睡眠剥夺是否对被试的皮层厚度（thickness）产生了一定的影响。<a id="more"></a></p>
<p>首先设置Freesurfer的环境变量SUBJECTS_DIR到数据所在目录，确保Freesufer能通过该环境变量找到需要分析的数据，命令如下：<br>    export SUBJECTS_DIR=~/subj/<br>这一步使用的命令在不同的系统上有所差异，export适用于Centos，其他google一下即可。</p>
<p>接下来就开始正式的工作，我们第一步需要获取需要分析的数据（比如每个被试右脑（rh）的皮层厚度（thickness）数据），并存在某个文件中。下面以获取8个被试的前后测的rh的thickness为例。<br>准备一个文本文件<code>pairs.fsgd</code>，内容格式如下：</p>
<pre><code>GroupDescriptorFile 1
Class Main
Input SD0101 Main
Input SD0102 Main
Input SD0201 Main
Input SD0202 Main
Input SD0401 Main
Input SD0402 Main
Input SD0501 Main
Input SD0502 Main
Input SD0601 Main
Input SD0602 Main
Input SD0701 Main
Input SD0702 Main
Input SD0801 Main
Input SD0802 Main
Input SD0901 Main
Input SD0902 Main
</code></pre><p>其中SD0101和SD0102分别是被试01的前后测编号，该文件主要用于通过下面的命令获取这些编号的thickness数据。</p>
<pre><code>mris_preproc --target fsaverage --hemi rh  --meas thickness --out rh.paired-diff.thickness.mgh    --fsgd pairs.fsgd --paired-diff
</code></pre><p>该命令会生成一个名为<code>rh.paired-diff.thickness.mgh</code>的文件，需要注意的是–paired-diff这个参数的指定，使文件<code>rh.paired-diff.thickness.mgh</code>中实际上是每个被试前后侧的差值，即SD0101-SD0102，SD0201-SD0202等。因此，上面准备的文本文件中，同一被试的前后侧一定要顺序一致，并保证连续。</p>
<p>接下来可以对生成的差异数据做一下平滑，以提高信噪比，不过这一步是可选的。<br>    mri_surf2surf –s fsaverage –hemi rh –fwhm 10 –sval rh.paired-diff.thickness.mgh  –tval rh.paired-diff.thickness.sm10.mgh</p>
<p>再接下来就可以针对平滑后的数据<code>rh.paired-diff.thickness.sm10.mgh</code>做统计了。首先需要准备两个简单的文本文件：<code>paired-diff.fsgd</code>和<code>mean.mtx</code>。文件<code>paired-diff.fsgd</code>的内容：<br>    GroupDescriptorFile 1<br>    Class Main<br>    Variables<br>    Input SD01 Main<br>    Input SD02 Main<br>    Input SD04 Main<br>    Input SD05 Main<br>    Input SD06 Main<br>    Input SD07 Main<br>    Input SD08 Main<br>    Input SD09 Main<br>文件<code>mean.mtx</code>的内容：<br>    1</p>
<p>准备好这些文件，就可以进行统计分析了。<br>    mri_glmfit –glmdir rh.paired-diff –y rh.paired-diff.thickness.sm10.mgh –fsgd paired-diff.fsgd –C mean.mtx –surf fsaverage rh</p>
<p>统计结果会生成在rh.paired-diff目录下的mean目录中，可以通过tksurfer命令可视化查看统计结果。</p>
<pre><code>tksurfer fsaverage rh inflated -overlay rh.paired-diff/mean/sig.mgh
</code></pre><p>也可以进一步对结果进行多重比较校正，查看校正后是否还有幸存的cluster。<br>    mri_glmfit-sim –glmdir rh.paired-diff –sim mc-z 5000 2 mc-z.abs –sim-sign abs –overwrite</p>
<p>可惜这个数据没有发现睡眠剥夺对皮层厚度的显著影响，原因可能有如下几条：</p>
<ol>
<li>样本量只有8名，被试量太少；</li>
<li>皮层thickness指标相对稳定，很难在较短的时间内发生变化；</li>
<li>thickness可能发生了变化，但是MRI的测量精度无法检测到这一变化；</li>
<li>可能在其他参数或测量的指标上有所变化。</li>
</ol>
<p>目前除了一篇in press的文章发现睡眠剥夺会影响丘脑volume外，暂时没有发现睡眠剥夺影响大脑结构的文献（小鼠或病人-正常人对照除外）。感兴趣的同学可以搞来试试，不过被试可就惨了点。毕竟，被剥夺了睡觉的权利不是什么好事情，甚至可能导致“屈打成招”，一样的道理，天天熬夜也不是什么好事情，最近有研究发现晚睡影响脑结构，也有最近的研究发现熬夜影响免疫力，总之熬夜不是好事情，好了，洗洗睡了吧。</p>
</div><iframe src="/donate/?AliPayQR=/images/al.jpg&amp;WeChatQR=/images/wx.jpg&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><div><ul class="post-copyright"><li class="post-copyright-author"><strong>Author: </strong>小孔成像</li><li class="post-copyright-link"><strong>Blog Link: </strong><a href="/2013/11/13/2013-11-13-paired-t-test-with-freesurfer-metrics/">http://conxz.net/2013/11/13/2013-11-13-paired-t-test-with-freesurfer-metrics/</a></li><li class="post-copyright-license"><strong>Copyright Declaration: </strong>The author owns the copyright (CC BY-NC-ND 4.0).</li></ul></div><br><br><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block;" data-ad-client="ca-pub-7680017147908727" data-ad-slot="2051716958" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});
</script><br><div class="tags"><a href="/tags/freesurfer/">freesurfer</a><a href="/tags/paired-t-test/">paired t-test</a></div><div class="post-nav"><a class="pre" href="/2013/11/14/2013-11-14-thoughts-on-an-article/">由一篇JN上的文章想到的</a><a class="next" href="/2013/11/08/2013-11-08-from-freesurfer-labels-to-volumetric-masks/">From freesurfer labels to volumetric masks</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://conxz.net/2013/11/13/2013-11-13-paired-t-test-with-freesurfer-metrics/';
    this.page.identifier = '2013/11/13/2013-11-13-paired-t-test-with-freesurfer-metrics/';
    this.page.title = '对surface参数做配对T检验:以睡眠剥夺实验为例';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//conimaging.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//conimaging.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://conimaging.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://conxz.net"></form></div><div class="widget"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:inline-block;width:200px;height:180px;" data-ad-client="ca-pub-7680017147908727" data-ad-slot="8940311518"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/python/" style="font-size: 19px;">python</a> <a href="/tags/mutual-information/" style="font-size: 15px;">mutual information</a> <a href="/tags/brain-asymmetry/" style="font-size: 19px;">brain asymmetry</a> <a href="/tags/life/" style="font-size: 15px;">life</a> <a href="/tags/2010s/" style="font-size: 15px;">2010s</a> <a href="/tags/freesurfer/" style="font-size: 21px;">freesurfer</a> <a href="/tags/paired-t-test/" style="font-size: 17px;">paired t-test</a> <a href="/tags/reading/" style="font-size: 15px;">reading</a> <a href="/tags/mvpa/" style="font-size: 17px;">mvpa</a> <a href="/tags/endnote/" style="font-size: 15px;">endnote</a> <a href="/tags/R/" style="font-size: 17px;">R</a> <a href="/tags/blog/" style="font-size: 19px;">blog</a> <a href="/tags/brain-network/" style="font-size: 17px;">brain network</a> <a href="/tags/two-sample-t-test/" style="font-size: 15px;">two-sample t-test</a> <a href="/tags/head-motion/" style="font-size: 19px;">head motion</a> <a href="/tags/afni/" style="font-size: 15px;">afni</a> <a href="/tags/bayes-factor/" style="font-size: 17px;">bayes factor</a> <a href="/tags/cognitive-neuroscience/" style="font-size: 15px;">cognitive neuroscience</a> <a href="/tags/open-science/" style="font-size: 25px;">open science</a> <a href="/tags/virtual-conference/" style="font-size: 15px;">virtual conference</a> <a href="/tags/gene/" style="font-size: 17px;">gene</a> <a href="/tags/conference/" style="font-size: 21px;">conference</a> <a href="/tags/presentation/" style="font-size: 19px;">presentation</a> <a href="/tags/learning/" style="font-size: 19px;">learning</a> <a href="/tags/language/" style="font-size: 15px;">language</a> <a href="/tags/language-network/" style="font-size: 15px;">language network</a> <a href="/tags/gene-expression/" style="font-size: 15px;">gene expression</a> <a href="/tags/imaging-genetics/" style="font-size: 15px;">imaging genetics</a> <a href="/tags/data-science/" style="font-size: 23px;">data science</a> <a href="/tags/pytorch/" style="font-size: 19px;">pytorch</a> <a href="/tags/machine-learning/" style="font-size: 19px;">machine learning</a> <a href="/tags/collaborative-team-research/" style="font-size: 17px;">collaborative team research</a> <a href="/tags/paper/" style="font-size: 23px;">paper</a> <a href="/tags/publication/" style="font-size: 21px;">publication</a> <a href="/tags/linux/" style="font-size: 17px;">linux</a> <a href="/tags/nohup/" style="font-size: 15px;">nohup</a> <a href="/tags/white-matter/" style="font-size: 15px;">white matter</a> <a href="/tags/google-adsense/" style="font-size: 15px;">google adsense</a> <a href="/tags/hippocampus/" style="font-size: 15px;">hippocampus</a> <a href="/tags/shiny-app/" style="font-size: 15px;">shiny app</a> <a href="/tags/data-sharing/" style="font-size: 19px;">data sharing</a> <a href="/tags/neuroscience/" style="font-size: 19px;">neuroscience</a> <a href="/tags/p-value/" style="font-size: 19px;">p value</a> <a href="/tags/navigation/" style="font-size: 17px;">navigation</a> <a href="/tags/navigation-network/" style="font-size: 15px;">navigation network</a> <a href="/tags/S100B/" style="font-size: 15px;">S100B</a> <a href="/tags/sex/" style="font-size: 15px;">sex</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//conimaging.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/05/02/CNS-Talks/">CNS报告</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/25/spatial-navigation-network-s100b/">空间导航脑网络和S100B基因</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/31/Gene-Expression-and-Language-Network/">脑影像遗传学：语言脑功能网络的基因表达相关</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/27/tab2space/">替换文本数据中的Tab为空格</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/14/Presentation-Learning-Day-3/">Presentation Learning Day 3</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/10/pytorch-example-3/">pytorch入门例子3：模型训练和测试</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/09/pytorch-example-2/">pytorch入门例子2</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/08/a-pytorch-example/">一个pytorch入门例子</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/08/presentation-learning-day-2/">Presentation Learning Day 2</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/07/presentation-learning-day-1/">Presentation Learning Day 1</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/BrainResearch/">BrainResearch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Methods/">Methods</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OpenScience/">OpenScience</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Xs/">Xs</a></li></ul></div><div class="widget"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block;" data-ad-client="ca-pub-7680017147908727" data-ad-slot="4501253490" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">小孔成像.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>